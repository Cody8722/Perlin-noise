<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>äºŒåˆ†æ¸¬è©¦</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1a1a1a; color: #fff; }
        .result { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #1a4d1a; border: 2px solid #00ff88; }
        .error { background: #4d1a1a; border: 2px solid #ff4444; }
    </style>
</head>
<body>
    <h1>ğŸ”¬ äºŒåˆ†æ¸¬è©¦ï¼šæ‰¾å‡ºå•é¡Œå‡½å¼</h1>
    <div id="results"></div>
    <script>
        const results = document.getElementById('results');

        function test(filename, description) {
            const div = document.createElement('div');
            div.innerHTML = `<strong>${description}</strong><br>æ¸¬è©¦ä¸­...`;
            results.appendChild(div);

            try {
                const worker = new Worker(`./js/${filename}`, { type: 'module' });

                worker.onmessage = (e) => {
                    div.className = 'result success';
                    div.innerHTML = `<strong>${description}</strong><br>âœ… æˆåŠŸï¼<br><pre>${JSON.stringify(e.data, null, 2)}</pre>`;
                };

                worker.onerror = (error) => {
                    div.className = 'result error';
                    div.innerHTML = `<strong>${description}</strong><br>âŒ å¤±æ•—ï¼<br>æª”æ¡ˆ: ${error.filename || '(æœªçŸ¥)'}<br>è¡Œ: ${error.lineno || '(æœªçŸ¥)'}`;
                };

                setTimeout(() => {
                    if (!div.className) {
                        div.className = 'result error';
                        div.innerHTML = `<strong>${description}</strong><br>âš ï¸ è¶…æ™‚ï¼ˆæ²’æœ‰å›æ‡‰ï¼‰`;
                    }
                }, 3000);
            } catch (error) {
                div.className = 'result error';
                div.innerHTML = `<strong>${description}</strong><br>âŒ å»ºæ§‹å¤±æ•—ï¼š${error.message}`;
            }
        }

        // åŸ·è¡Œæ¸¬è©¦åºåˆ— - é€æ­¥æ“´å±•æ¸¬è©¦
        setTimeout(() => test('test-terrain-init-only.worker.js', 'âœ… åªæœ‰ handleInit'), 100);
        setTimeout(() => test('test-both-functions.worker.js', 'âœ… handleInit + ç°¡åŒ– GenerateRivers (line 125)'), 3500);
        setTimeout(() => test('test-expanded-v1.worker.js', 'ğŸ” v1: æ“´å±•åˆ° line 166 (é™¸åœ°æ”¶é›†)'), 7000);
        setTimeout(() => test('test-expanded-v2.worker.js', 'ğŸ” v2: å®Œæ•´ handleGenerateRivers (line 220)'), 10500);
        setTimeout(() => test('test-expanded-v3.worker.js', 'ğŸ” v3: + simulateDroplet (line 410)'), 14000);
        setTimeout(() => test('test-expanded-v4.worker.js', 'ğŸ” v4: + handleGeneratePreview (line 576)'), 17500);
        setTimeout(() => test('test-terrain-copy.worker.js', 'âŒ èˆŠç‰ˆå®Œæ•´æª”æ¡ˆ (æœ‰ bug)'), 21000);
        setTimeout(() => test('test-terrain-fixed.worker.js', 'ğŸ‰ ä¿®å¾©å¾Œçš„å®Œæ•´æª”æ¡ˆ'), 24500);
    </script>
</body>
</html>
